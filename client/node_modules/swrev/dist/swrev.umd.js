var z=Object.defineProperty,B=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var C=(r,i,a)=>i in r?z(r,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[i]=a,n=(r,i)=>{for(var a in i||(i={}))J.call(i,a)&&C(r,a,i[a]);if(A)for(var a of A(i))N.call(i,a)&&C(r,a,i[a]);return r},D=(r,i)=>B(r,G(i));var f=(r,i,a)=>(C(r,typeof i!="symbol"?i+"":i,a),a);(function(r,i){typeof exports=="object"&&typeof module!="undefined"?i(exports):typeof define=="function"&&define.amd?define(["exports"],i):(r=typeof globalThis!="undefined"?globalThis:r||self,i(r.swrev={}))})(this,function(r){"use strict";class i{constructor(){f(this,"listeners",new Map)}subscribe(e,t){this.listeners.has(e)||this.listeners.set(e,[]),!this.listeners.get(e).includes(t)&&this.listeners.get(e).push(t)}unsubscribe(e,t){!this.listeners.has(e)||!this.listeners.get(e).includes(t)||(this.listeners.get(e).splice(this.listeners.get(e).indexOf(t),1),this.listeners.get(e).length===0&&this.listeners.delete(e))}emit(e,t){!this.listeners.has(e)||this.listeners.get(e).forEach(s=>s(t))}}const a={broadcast:!1},E={broadcast:!1};class b{constructor({data:e,expiresAt:t=null}){f(this,"data");f(this,"expiresAt");this.data=e,this.expiresAt=t}isResolving(){return this.data instanceof Promise}hasExpired(){return this.expiresAt===null||this.expiresAt<new Date}expiresIn(e){return this.expiresAt=new Date,this.expiresAt.setMilliseconds(this.expiresAt.getMilliseconds()+e),this}}class I{constructor(){f(this,"elements",new Map);f(this,"event",new i)}resolve(e,t){Promise.resolve(t.data).then(s=>{if(s==null)return this.remove(e);t.data=s,this.broadcast(e,s)})}get(e){return this.elements.get(e)}set(e,t){this.elements.set(e,t),this.resolve(e,t)}remove(e,t){const{broadcast:s}=n(n({},a),t);s&&this.broadcast(e,void 0),this.elements.delete(e)}clear(e){const{broadcast:t}=n(n({},E),e);if(t)for(const s of this.elements.keys())this.broadcast(s,void 0);this.elements.clear()}has(e){return this.elements.has(e)}subscribe(e,t){this.event.subscribe(e,t)}unsubscribe(e,t){this.event.unsubscribe(e,t)}broadcast(e,t){this.event.emit(e,t)}}const p={cache:new I,errors:new i,fetcher:async u=>{const e=await fetch(u);if(!e.ok)throw Error("Not a 2XX response.");return e.json()},initialData:void 0,loadInitialCache:!0,revalidateOnStart:!0,dedupingInterval:2e3,revalidateOnFocus:!0,focusThrottleInterval:5e3,revalidateOnReconnect:!0,reconnectWhen:(u,{enabled:e})=>e&&typeof window!="undefined"?(window.addEventListener("online",u),()=>window.removeEventListener("online",u)):()=>{},focusWhen:(u,{enabled:e,throttleInterval:t})=>{if(e&&typeof window!="undefined"){let s=null;const o=()=>{const l=Date.now();(s===null||l-s>t)&&(s=l,u())};return window.addEventListener("focus",o),()=>window.removeEventListener("focus",o)}return()=>{}}},g=D(n({},p),{force:!1}),R={revalidate:!0,revalidateOptions:n({},g)},M={broadcast:!1};class W{constructor(e){f(this,"options");this.options=n(n({},p),e)}get cache(){return this.options.cache}get errors(){return this.options.errors}requestData(e,t){return Promise.resolve(t(e)).catch(s=>{this.errors.emit(e,s)})}resolveKey(e){if(typeof e=="function")try{return e()}catch{return}return e}clear(e,t){const s=n(n({},M),t);if(e==null)return this.cache.clear(s);if(!Array.isArray(e))return this.cache.remove(e,s);for(const o of e)this.cache.remove(o,s)}revalidate(e,t){if(!e)return;const{fetcher:s,dedupingInterval:o}=this.options,{force:l,fetcher:c,dedupingInterval:h}=n(D(n({},g),{fetcher:s,dedupingInterval:o}),t);let d;(l||!this.cache.has(e)||this.cache.has(e)&&this.cache.get(e).hasExpired())&&(d=this.requestData(e,c)),d!==void 0&&this.mutate(e,new b({data:d}).expiresIn(h),{revalidate:!1})}mutate(e,t,s){if(!e)return;const{revalidate:o,revalidateOptions:l}=n(n({},R),s);let c;if(typeof t=="function"){let h=null;if(this.cache.has(e)){const d=this.cache.get(e);d.isResolving()||(h=d.data)}c=t(h)}else c=t;this.cache.set(e,c instanceof b?c:new b({data:c})),o&&this.revalidate(e,l)}subscribeData(e,t){if(e){const s=o=>t(o);return this.cache.subscribe(e,s),()=>this.cache.unsubscribe(e,s)}return()=>{}}subscribeErrors(e,t){if(e){const s=o=>t(o);return this.errors.subscribe(e,s),()=>this.errors.unsubscribe(e,s)}return()=>{}}get(e){if(e&&this.cache.has(e)){const t=this.cache.get(e);if(!t.isResolving())return t.data}}getWait(e){return new Promise((t,s)=>{const o=this.subscribeData(e,h=>(o(),t(h))),l=this.subscribeErrors(e,h=>(l(),s(h))),c=this.get(e);if(c)return t(c)})}subscribe(e,t,s,o){const{fetcher:l,initialData:c,loadInitialCache:h,revalidateOnStart:d,dedupingInterval:S,revalidateOnFocus:K,focusThrottleInterval:x,revalidateOnReconnect:P,reconnectWhen:T,focusWhen:F}=n(n({},this.options),o),L=(v,H)=>this.mutate(this.resolveKey(e),v,H),j=v=>this.revalidate(this.resolveKey(e),v),m=()=>j({fetcher:l,dedupingInterval:S});d&&m();const q=this.subscribeData(this.resolveKey(e),t),X=this.subscribeErrors(this.resolveKey(e),s),w=F(m,{throttleInterval:x,enabled:K}),O=T(m,{enabled:P}),_=()=>{q(),X(),w==null||w(),O==null||O()};if(c&&L(c,{revalidate:!1}),h){const v=this.get(this.resolveKey(e));v&&t(v)}return{unsubscribe:_}}}r.CacheItem=b,r.DefaultCache=I,r.DefaultSWREventManager=i,r.SWR=W,r.defaultCacheClearOptions=E,r.defaultCacheRemoveOptions=a,r.defaultClearOptions=M,r.defaultMutateOptions=R,r.defaultOptions=p,r.defaultRevalidateOptions=g,Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
